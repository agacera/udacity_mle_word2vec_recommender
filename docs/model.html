---

title: Word2VeC Reommender
keywords: fastai
sidebar: home_sidebar

summary: "API details."
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 00_model.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="GensimParameters" class="doc_header"><code>class</code> <code>GensimParameters</code><a href="https://github.com/agacera/udacity_mle_word2vec_recommender/tree/master/udacity_mle_word2vec_recommender/model.py#L30" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>GensimParameters</code>(<strong><code>window</code></strong>:<code>int</code>=<em><code>10</code></em>, <strong><code>iter</code></strong>:<code>int</code>=<em><code>20</code></em>, <strong><code>sg</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>hs</code></strong>:<code>int</code>=<em><code>0</code></em>, <strong><code>negative</code></strong>:<code>int</code>=<em><code>10</code></em>, <strong><code>alpha</code></strong>:<code>float</code>=<em><code>0.03</code></em>, <strong><code>min_alpha</code></strong>:<code>float</code>=<em><code>0.0007</code></em>, <strong><code>seed</code></strong>:<code>int</code>=<em><code>14</code></em>, <strong><code>compute_loss</code></strong>:<code>bool</code>=<em><code>True</code></em>) :: <code>tuple</code></p>
</blockquote>
<p>GensimParameters(window, iter, sg, hs, negative, alpha, min_alpha, seed, compute_loss)</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gensim_parameters</span> <span class="o">=</span> <span class="n">GensimParameters</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="generate_sentences_by_user" class="doc_header"><code>generate_sentences_by_user</code><a href="https://github.com/agacera/udacity_mle_word2vec_recommender/tree/master/udacity_mle_word2vec_recommender/model.py#L42" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>generate_sentences_by_user</code>(<strong><code>df</code></strong>:<code>DataFrame</code>)</p>
</blockquote>
<p>Generate the Gensin sentences for a dataframe.
Each sentence is created by joining all ratings from a user sorted by timestamp.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Recommendation" class="doc_header"><code>class</code> <code>Recommendation</code><a href="https://github.com/agacera/udacity_mle_word2vec_recommender/tree/master/udacity_mle_word2vec_recommender/model.py#L95" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Recommendation</code>(<strong><code>movie_id</code></strong>:<code>int</code>, <strong><code>score</code></strong>:<code>float</code>) :: <code>tuple</code></p>
</blockquote>
<p>Recommendation(movie_id, score)</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Movie" class="doc_header"><code>class</code> <code>Movie</code><a href="https://github.com/agacera/udacity_mle_word2vec_recommender/tree/master/udacity_mle_word2vec_recommender/model.py#L101" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Movie</code>(<strong><code>movie_id</code></strong>:<code>int</code>, <strong><code>title</code></strong>:<code>str</code>, <strong><code>genres</code></strong>:<code>str</code>)</p>
</blockquote>
<p>Movie(movie_id: int, title: str, genres: str)</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="MovieRepository" class="doc_header"><code>class</code> <code>MovieRepository</code><a href="https://github.com/agacera/udacity_mle_word2vec_recommender/tree/master/udacity_mle_word2vec_recommender/model.py#L107" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>MovieRepository</code>(<strong><code>movies_df</code></strong>:<code>DataFrame</code>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Word2VecMovieRecommender" class="doc_header"><code>class</code> <code>Word2VecMovieRecommender</code><a href="https://github.com/agacera/udacity_mle_word2vec_recommender/tree/master/udacity_mle_word2vec_recommender/model.py#L124" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Word2VecMovieRecommender</code>(<strong><code>movies_df</code></strong>:<code>DataFrame</code>, <strong><code>ratings_df</code></strong>:<code>DataFrame</code>, <strong><code>gensim_parameters</code></strong>:<a href="model.html#GensimParameters"><code>GensimParameters</code></a>, <strong><code>positive_rating_threshold</code></strong>:<code>float</code>=<em><code>3.0</code></em>, <strong><code>train_validation_ratio</code></strong>:<code>float</code>=<em><code>0.9</code></em>)</p>
</blockquote>
<p>This class encapsulates the training of recommendations plus utilities for persistance and predictions</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">movies_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/ml-latest-small/movies.csv&#39;</span><span class="p">)</span>
<span class="n">movies_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>movieId</th>
      <th>title</th>
      <th>genres</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Toy Story (1995)</td>
      <td>Adventure|Animation|Children|Comedy|Fantasy</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Jumanji (1995)</td>
      <td>Adventure|Children|Fantasy</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Grumpier Old Men (1995)</td>
      <td>Comedy|Romance</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Waiting to Exhale (1995)</td>
      <td>Comedy|Drama|Romance</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Father of the Bride Part II (1995)</td>
      <td>Comedy</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ratings_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/ml-latest-small/ratings.csv&#39;</span><span class="p">)</span>
<span class="n">ratings_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>userId</th>
      <th>movieId</th>
      <th>rating</th>
      <th>timestamp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>4.0</td>
      <td>964982703</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>3</td>
      <td>4.0</td>
      <td>964981247</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>6</td>
      <td>4.0</td>
      <td>964982224</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>47</td>
      <td>5.0</td>
      <td>964983815</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>50</td>
      <td>5.0</td>
      <td>964982931</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">movie_repository</span> <span class="o">=</span> <span class="n">MovieRepository</span><span class="p">(</span>
    <span class="n">movies_df</span><span class="o">=</span><span class="n">movies_df</span>
<span class="p">)</span>

<span class="n">movie_repository</span><span class="o">.</span><span class="n">find_by_movie_id</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Movie(movie_id=1, title=&#39;Toy Story (1995)&#39;, genres=&#39;Adventure|Animation|Children|Comedy|Fantasy&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">word2vec_recommender</span> <span class="o">=</span> <span class="n">Word2VecMovieRecommender</span><span class="p">(</span>
    <span class="n">movies_df</span><span class="o">=</span><span class="n">movies_df</span><span class="p">,</span>
    <span class="n">ratings_df</span><span class="o">=</span><span class="n">ratings_df</span><span class="p">,</span>
    <span class="n">gensim_parameters</span><span class="o">=</span><span class="n">gensim_parameters</span>
<span class="p">)</span>

<span class="n">word2vec_recommender</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>movies=(9742, 3), ratings=(100836, 4), train_df=(74918, 6), validation_df=(6845, 6)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">word2vec_recommender</span><span class="o">.</span><span class="n">train_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>movieId</th>
      <th>userId</th>
      <th>rating</th>
      <th>timestamp</th>
      <th>title</th>
      <th>genres</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>43</th>
      <td>804</td>
      <td>1</td>
      <td>4.0</td>
      <td>964980499</td>
      <td>She's the One (1996)</td>
      <td>Comedy|Romance</td>
    </tr>
    <tr>
      <th>73</th>
      <td>1210</td>
      <td>1</td>
      <td>5.0</td>
      <td>964980499</td>
      <td>Star Wars: Episode VI - Return of the Jedi (1983)</td>
      <td>Action|Adventure|Sci-Fi</td>
    </tr>
    <tr>
      <th>120</th>
      <td>2018</td>
      <td>1</td>
      <td>5.0</td>
      <td>964980523</td>
      <td>Bambi (1942)</td>
      <td>Animation|Children|Drama</td>
    </tr>
    <tr>
      <th>171</th>
      <td>2628</td>
      <td>1</td>
      <td>4.0</td>
      <td>964980523</td>
      <td>Star Wars: Episode I - The Phantom Menace (1999)</td>
      <td>Action|Adventure|Sci-Fi</td>
    </tr>
    <tr>
      <th>183</th>
      <td>2826</td>
      <td>1</td>
      <td>4.0</td>
      <td>964980523</td>
      <td>13th Warrior, The (1999)</td>
      <td>Action|Adventure|Fantasy</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># sampling of interactions</span>
<span class="n">generate_sentences_by_user</span><span class="p">(</span><span class="n">word2vec_recommender</span><span class="o">.</span><span class="n">train_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[[&#39;804&#39;, &#39;1210&#39;, &#39;2018&#39;, &#39;2628&#39;, &#39;2826&#39;, &#39;3578&#39;, &#39;3617&#39;, &#39;3744&#39;, &#39;101&#39;, &#39;441&#39;]]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">word2vec_recommender</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">print_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch #1 start
Epoch #1 end in 0:00:00.397219 time
Epoch #1, loss 1018090.1875
Epoch #2 start
Epoch #2 end in 0:00:00.417477 time
Epoch #2, loss 1818709.5
Epoch #3 start
Epoch #3 end in 0:00:00.439693 time
Epoch #3, loss 2537651.25
Epoch #4 start
Epoch #4 end in 0:00:00.478055 time
Epoch #4, loss 3249514.25
Epoch #5 start
Epoch #5 end in 0:00:00.411225 time
Epoch #5, loss 3936500.25
Epoch #6 start
Epoch #6 end in 0:00:00.484019 time
Epoch #6, loss 4574167.0
Epoch #7 start
Epoch #7 end in 0:00:00.436841 time
Epoch #7, loss 5185125.0
Epoch #8 start
Epoch #8 end in 0:00:00.492540 time
Epoch #8, loss 5795565.0
Epoch #9 start
Epoch #9 end in 0:00:00.462706 time
Epoch #9, loss 6396374.0
Epoch #10 start
Epoch #10 end in 0:00:00.443660 time
Epoch #10, loss 6997948.5
Epoch #11 start
Epoch #11 end in 0:00:00.468188 time
Epoch #11, loss 7608853.0
Epoch #12 start
Epoch #12 end in 0:00:00.424226 time
Epoch #12, loss 8205345.0
Epoch #13 start
Epoch #13 end in 0:00:00.448770 time
Epoch #13, loss 8757826.0
Epoch #14 start
Epoch #14 end in 0:00:00.434563 time
Epoch #14, loss 9292135.0
Epoch #15 start
Epoch #15 end in 0:00:00.429043 time
Epoch #15, loss 9822197.0
Epoch #16 start
Epoch #16 end in 0:00:00.415106 time
Epoch #16, loss 10352795.0
Epoch #17 start
Epoch #17 end in 0:00:00.461292 time
Epoch #17, loss 10893168.0
Epoch #18 start
Epoch #18 end in 0:00:00.431160 time
Epoch #18, loss 11420117.0
Epoch #19 start
Epoch #19 end in 0:00:00.487156 time
Epoch #19, loss 11943004.0
Epoch #20 start
Epoch #20 end in 0:00:00.413705 time
Epoch #20, loss 12472696.0
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Generating Recommendations</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">_print_recommendations</span><span class="p">(</span><span class="n">recommender</span><span class="p">,</span> <span class="n">movie_repository</span><span class="p">,</span> <span class="n">movie_id</span><span class="p">):</span>
    <span class="n">seed</span> <span class="o">=</span> <span class="n">movie_repository</span><span class="o">.</span><span class="n">find_by_movie_id</span><span class="p">(</span><span class="n">movie_id</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&gt;&gt;&gt;&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">recommender</span><span class="o">.</span><span class="n">similar_by_movie_id</span><span class="p">(</span><span class="n">movie_id</span><span class="p">):</span>
        <span class="n">movie</span> <span class="o">=</span> <span class="n">movie_repository</span><span class="o">.</span><span class="n">find_by_movie_id</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">movie_id</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">movie</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_print_recommendations</span><span class="p">(</span><span class="n">word2vec_recommender</span><span class="p">,</span> <span class="n">movie_repository</span><span class="p">,</span> <span class="mi">1210</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Movie(movie_id=1210, title=&#39;Star Wars: Episode VI - Return of the Jedi (1983)&#39;, genres=&#39;Action|Adventure|Sci-Fi&#39;)
&gt;&gt;&gt;
Movie(movie_id=1196, title=&#39;Star Wars: Episode V - The Empire Strikes Back (1980)&#39;, genres=&#39;Action|Adventure|Sci-Fi&#39;)
Movie(movie_id=260, title=&#39;Star Wars: Episode IV - A New Hope (1977)&#39;, genres=&#39;Action|Adventure|Sci-Fi&#39;)
Movie(movie_id=66, title=&#39;Lawnmower Man 2: Beyond Cyberspace (1996)&#39;, genres=&#39;Action|Sci-Fi|Thriller&#39;)
Movie(movie_id=2571, title=&#39;Matrix, The (1999)&#39;, genres=&#39;Action|Sci-Fi|Thriller&#39;)
Movie(movie_id=1073, title=&#39;Willy Wonka &amp; the Chocolate Factory (1971)&#39;, genres=&#39;Children|Comedy|Fantasy|Musical&#39;)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_print_recommendations</span><span class="p">(</span><span class="n">word2vec_recommender</span><span class="p">,</span> <span class="n">movie_repository</span><span class="p">,</span> <span class="mi">110</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Movie(movie_id=110, title=&#39;Braveheart (1995)&#39;, genres=&#39;Action|Drama|War&#39;)
&gt;&gt;&gt;
Movie(movie_id=356, title=&#39;Forrest Gump (1994)&#39;, genres=&#39;Comedy|Drama|Romance|War&#39;)
Movie(movie_id=2028, title=&#39;Saving Private Ryan (1998)&#39;, genres=&#39;Action|Drama|War&#39;)
Movie(movie_id=457, title=&#39;Fugitive, The (1993)&#39;, genres=&#39;Thriller&#39;)
Movie(movie_id=589, title=&#39;Terminator 2: Judgment Day (1991)&#39;, genres=&#39;Action|Sci-Fi&#39;)
Movie(movie_id=593, title=&#39;Silence of the Lambs, The (1991)&#39;, genres=&#39;Crime|Horror|Thriller&#39;)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Generating Recommendations from Embeddings directly.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="KnnRecommender" class="doc_header"><code>class</code> <code>KnnRecommender</code><a href="https://github.com/agacera/udacity_mle_word2vec_recommender/tree/master/udacity_mle_word2vec_recommender/model.py#L189" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>KnnRecommender</code>(<strong><code>word_indexes</code></strong>:<code>List</code>[<code>str</code>], <strong><code>embeddings</code></strong>:<code>array</code>, <strong><code>n_recommendations</code></strong>:<code>int</code>=<em><code>10</code></em>, <strong><code>algorithm</code></strong>:<code>str</code>=<em><code>'brute'</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># using scikit learning to </span>
<span class="n">knn_recommender</span> <span class="o">=</span> <span class="n">KnnRecommender</span><span class="p">(</span>
    <span class="n">word_indexes</span><span class="o">=</span><span class="n">word2vec_recommender</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">wv</span><span class="o">.</span><span class="n">index2word</span><span class="p">,</span> 
    <span class="n">embeddings</span><span class="o">=</span><span class="n">word2vec_recommender</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">wv</span><span class="o">.</span><span class="n">vectors</span><span class="p">)</span>

<span class="n">knn_recommender</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">knn_recommender</span><span class="o">.</span><span class="n">recommend_by_index</span><span class="p">(</span><span class="mi">654</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[(4734, 0.87390256),
 (6503, 0.87976795),
 (6536, 0.9101007),
 (5785, 0.9383729),
 (8781, 0.94144326),
 (7263, 0.9427485),
 (6881, 0.9495256),
 (8641, 0.9501852),
 (6296, 0.952425)]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">word2vec_recommender</span><span class="o">.</span><span class="n">similar_by_movie_id</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">word_indexes</span><span class="p">[</span><span class="mi">654</span><span class="p">]),</span> <span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(Movie(movie_id=6188, title=&#39;Old School (2003)&#39;, genres=&#39;Comedy&#39;),
 [(Movie(movie_id=4734, title=&#39;Jay and Silent Bob Strike Back (2001)&#39;, genres=&#39;Adventure|Comedy&#39;),
   0.618147075176239),
  (Movie(movie_id=6503, title=&#34;Charlie&#39;s Angels: Full Throttle (2003)&#34;, genres=&#39;Action|Adventure|Comedy|Crime|Thriller&#39;),
   0.613004207611084),
  (Movie(movie_id=6536, title=&#39;Sinbad: Legend of the Seven Seas (2003)&#39;, genres=&#39;Adventure|Animation|Children|Fantasy&#39;),
   0.5858583450317383),
  (Movie(movie_id=5785, title=&#39;Jackass: The Movie (2002)&#39;, genres=&#39;Action|Comedy|Documentary&#39;),
   0.5597281455993652),
  (Movie(movie_id=8781, title=&#39;Manchurian Candidate, The (2004)&#39;, genres=&#39;Thriller&#39;),
   0.5568422675132751),
  (Movie(movie_id=7263, title=&#39;Miracle (2004)&#39;, genres=&#39;Drama&#39;),
   0.5556126832962036),
  (Movie(movie_id=6881, title=&#39;Pieces of April (2003)&#39;, genres=&#39;Comedy|Drama&#39;),
   0.5492005944252014),
  (Movie(movie_id=8641, title=&#39;Anchorman: The Legend of Ron Burgundy (2004)&#39;, genres=&#39;Comedy&#39;),
   0.5485740900039673),
  (Movie(movie_id=6296, title=&#39;Mighty Wind, A (2003)&#39;, genres=&#39;Comedy|Musical&#39;),
   0.5464432239532471),
  (Movie(movie_id=5283, title=&#34;National Lampoon&#39;s Van Wilder (2002)&#34;, genres=&#39;Comedy&#39;),
   0.5433087348937988)])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Saving embeddings</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">word2vec_recommender</span><span class="o">.</span><span class="n">save_embeddings</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s1">&#39;./data/out&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Plotting embeddings</p>

</div>
</div>
</div>
</div>
 

